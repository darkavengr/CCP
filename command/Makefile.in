ASM=@asm@
CC=@cc@
LD=@ld@
CCFLAGS=-c -w -ffreestanding -g -lgcc -Wl,-Map -Wl,@buildroot@/mapfiles/command.map
LDFLAGS=-ffreestanding -nostdlib -T ld.script.command  -Wl,-Map -Wl,@buildroot@/mapfiles/command.map
OBJFILES=command.o string.o error.o addvar.o copyfile.o err.o getfullpath.o kprintf_direct.o readline.o runcommand.o call.o
OUTFILE=@buildroot@/bin/@arch@/COMMAND.RUN 

all: 	$(OBJFILES)
	$(CC) -o $(OUTFILE) $(OBJFILES) $(LDFLAGS)

addvar.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ addvar.c

command.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ command.c

copyfile.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ copyfile.c

err.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ err.c

getfullpath.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ ../kernel/getfullpath.c

kprintf_direct.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ ../header/kprintf_direct.c

readline.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ readline.c

runcommand.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ runcommand.c

string.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ @buildroot@/header/string.c

error.o:
	$(CC) $(CCFLAGS) -I@buildroot@/header -I@buildroot@/kernel/hwdep/@arch@ @buildroot@/header/error.c

call.o:
	$(ASM) @asm_opts@ @arch@/call.asm -o call.o

clean:
	rm @buildroot@/bin/@arch@/COMMAND.RUN *.o

